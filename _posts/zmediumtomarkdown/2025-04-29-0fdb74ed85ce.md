---
title: "【Omniverse Farm】學習筆記 — 00：OVX"
author: "帽捲"
date: 2025-04-29T09:23:44.966+0000
last_modified_at: 2025-05-07T06:54:56.515+0000
categories: ["Maochinn"]
tags: ["omniverse","farm","nvidia"]
description: "OVX是NVIDIA專門為了Omniverse所開發的系統，雖然在本質上OVX 系統就是高效能 GPU Linux 伺服器，操作上跟 Ubuntu 或 HPC 節點差不多，只是針對 Omniverse 生態系做了優化。"
image:
  path: /assets/0fdb74ed85ce/0*gT_FAim8Iyh9LvMy.png
render_with_liquid: false
---

### 【Omniverse Farm】Omniverse Farm學習筆記 — 00：OVX

OVX是NVIDIA專門為了Omniverse所開發的系統，雖然在本質上OVX 系統就是高效能 GPU Linux 伺服器，操作上跟 Ubuntu 或 HPC 節點差不多，只是針對 Omniverse 生態系做了優化。


[![](https://www.nvidia.com/content/dam/en-zz/Solutions/omniverse/platform/nvidia-ovx-og-image-1200x630.jpg)](https://www.nvidia.com/en-us/data-center/products/ovx/){:target="_blank"}


也就是說你可以用 SSH 操作、跑 Docker、部署應用，也可以進一步整合 Omniverse Farm 或 Isaac Sim 等模擬工具，因為搭載這個系統的伺服器是專為Omniverse打造的，因此配備的GPU主要還是用於繪圖，例如：L40, A40, A6000或RTX 6000 Ada等，這些顯卡比較接近常見的RTX顯卡，主要的差異在於企業級的GPU會是為了長期穩定運作而設計，並且支援大量的擴充，甚至會對特定軟體的優化，例如Omniverse，相反，一般的消費級GPU雖然表現上未必會輸，但是通常不會長時間的運行，且通常不會對特定軟體優化。

那麼OVX的機器有許多並不是讓使用者直接ssh連接進去，而是透過Omniverse Farm這個系統來讓使用者submit各種task，OV farm會自動排程，並且產生對應的log。
### Omniverse Farm

就如同名稱所述，我們可以透過Omniverse Farm這個工具，將電腦做為一個算力的農場，換言之，這個工具可以run自己的PC或是公司的server上都行，例如可以在裝有3090的PC上運行這個工具，讓其他人可以用它來算繪。

[**Omniverse Farm \- Omniverse Farm**](https://docs.omniverse.nvidia.com/farm/latest/index.html){:target="_blank"} 
[_Omniverse Farm allows you to run tasks in the background, and to run automated jobs defined by you or others\._ docs\.omniverse\.nvidia\.com](https://docs.omniverse.nvidia.com/farm/latest/index.html){:target="_blank"}

因此，本篇將介紹，怎麼在本地的Windows PC上運行OV farm，並且再從本地submit task，由此來了解OV farm的操作，這邊大致流程請參考官方教學。

[**Installation of Omniverse Farm on Windows in Standalone Mode**](https://docs.omniverse.nvidia.com/farm/latest/deployments/standalone.html){:target="_blank"} 
[_This guide walks through installing Omniverse Farm as a standalone solution on Windows or Linux\. It is suitable for use…_ docs\.omniverse\.nvidia\.com](https://docs.omniverse.nvidia.com/farm/latest/deployments/standalone.html){:target="_blank"}

首先這邊有一些要求，
- Windows 10 or later
- Ubuntu 22\.04 LTS or later
- [Python](https://python.org/){:target="_blank"} 3\.10 or later


因為需要用python跑\.whl來設定我們的環境，我這邊先用conda來開環境
```lua
conda create -n ov_farm
conda activate ov_farm   
conda install python=3.10
```

然後就照官方的步驟來，先從NGC抓檔案下來，然後解壓縮下來應該會看到\.whl，然後跑
```css
python -m pip install --find-links dependencies nv_svc_farm-2.0.42-py3-none-any.whl
```

之後跑完之後，應該就可以在conda中執行
```typescript
farm
```

應該會跳出一堆log，那就表示已經把services開起來了，然後開了一個cmd，輸入
```bash
curl http://localhost:8222/status
```

應該會看到
```bash
"OK"
```

就表示有連上，實際上OV farm的服務由兩個部分組成，分別是Queue跟Agent，簡單來說就是使用者跟Queue互動，然後Queue會將要做的task分配給Agent去完成，換言之，實際的算力是在Agent，但是使用者不能直接接觸到他們，得要透過Queue。


![Figure 1\. [https://docs\.omniverse\.nvidia\.com/farm/latest/architecture/index\.html](https://docs.omniverse.nvidia.com/farm/latest/architecture/index.html){:target="_blank"}](/assets/0fdb74ed85ce/0*gT_FAim8Iyh9LvMy.png)

Figure 1\. [https://docs\.omniverse\.nvidia\.com/farm/latest/architecture/index\.html](https://docs.omniverse.nvidia.com/farm/latest/architecture/index.html){:target="_blank"}

但也換言之，Queue跟Agent不一定會在同一台機器上，所以我們可以單獨啟動Queue或是Agent，透過 `farm-api` 或是 `controller-svc` 詳情可以參考

[**Installation of Omniverse Farm on Windows in Standalone Mode**](https://docs.omniverse.nvidia.com/farm/latest/deployments/standalone.html#configuring-separate-farm-queue-and-agent-s){:target="_blank"} 
[_This guide walks through installing Omniverse Farm as a standalone solution on Windows or Linux\. It is suitable for use…_ docs\.omniverse\.nvidia\.com](https://docs.omniverse.nvidia.com/farm/latest/deployments/standalone.html#configuring-separate-farm-queue-and-agent-s){:target="_blank"}

[**Migrating to Farm 2\.0 Standalone \- Omniverse Farm**](https://docs.omniverse.nvidia.com/farm/latest/guides/migrate_to_farm2.html){:target="_blank"} 
[_This guide provides information to help migrate from Omniverse Launcher based installations of Farm 105\.x and 106\.x to…_ docs\.omniverse\.nvidia\.com](https://docs.omniverse.nvidia.com/farm/latest/guides/migrate_to_farm2.html){:target="_blank"}

但是，我們此處先把問題簡化，兩者都在同個機器上，我們可以用瀏覽器打開http://localhost:8222/queue/management/dashboard/，應該可以看到類似這樣的畫面


![Figure 2\. [https://docs\.omniverse\.nvidia\.com/farm/latest/queue\.html](https://docs.omniverse.nvidia.com/farm/latest/queue.html){:target="_blank"}](/assets/0fdb74ed85ce/0*t2bd3MXUfwfpcesy.png)

Figure 2\. [https://docs\.omniverse\.nvidia\.com/farm/latest/queue\.html](https://docs.omniverse.nvidia.com/farm/latest/queue.html){:target="_blank"}

到此為止，我們在自己的PC上啟動了一個farm instance，我們可以跟著這個文件來進一步測試instance有沒有正常運作。

[**Testing Your Farm Instance \- Omniverse Farm**](https://docs.omniverse.nvidia.com/farm/latest/guides/testing_farm.html){:target="_blank"} 
[_With your Farm instance up and running, you'll want to confirm that everything is functioning as it should\. This…_ docs\.omniverse\.nvidia\.com](https://docs.omniverse.nvidia.com/farm/latest/guides/testing_farm.html){:target="_blank"}

我們需要實際的submit一個task給Queue，但在submit之前，我們需要先upload job definition，我們需要先將job的定義寫在\.kit中，然後使用Queue的API來上傳這個job。
```bash
/queue/management/jobs/save
```

為什麼要傳job？因為task中需要定義task type，表示這個task該怎麼被執行，而task type具體的種類實際上就是job的種類，舉實例來說，我們定義了一個 **_rendering_** 的job，裏頭可能描述了要使用甚麼command做render，然後之後就可以submit多個 _task type_ 為 **_rendering_** 的task，每一個task會詳細的敘述一些客製化的參數，例如mesh的路徑等等，但共同點都是會使用同一個command去運行。

以這邊的例子來說，他在hello\-world\.kit定義了一個名稱為 **_hello\-world_** 的job，這個job的command就是啟動python，然後用python的語法來print Hello\_World\!。


![Figure 3\. [https://docs\.omniverse\.nvidia\.com/farm/latest/guides/testing\_farm\.html\#hello\-world](https://docs.omniverse.nvidia.com/farm/latest/guides/testing_farm.html#hello-world){:target="_blank"}](/assets/0fdb74ed85ce/1*3bszzFo3otZeiZk-pdKSuA.png)

Figure 3\. [https://docs\.omniverse\.nvidia\.com/farm/latest/guides/testing\_farm\.html\#hello\-world](https://docs.omniverse.nvidia.com/farm/latest/guides/testing_farm.html#hello-world){:target="_blank"}

這邊官方很貼心的提供了一個python腳本用更簡單的方式將該job上傳到job stores中，但其實還是透過/queue/management/jobs/save來上傳job。
```bash
python job_definition_upload.py hello-world.kit --farm-url http://localhost:8222 --api-key change-me
```

上傳完成後，可以這個API
```bash
/queue/management/jobs/load
```

來查看job stores中所有的jobs，來確認有沒有上傳成功，實際上jobs就是儲存在Queue中，至於job stores的細節可以參考

[**Job Stores \- Omniverse Farm**](https://docs.omniverse.nvidia.com/farm/latest/guides/job_stores.html){:target="_blank"} 
[_Note This guide presumes you already have basic understanding of how to create configuration TOML files and how to…_ docs\.omniverse\.nvidia\.com](https://docs.omniverse.nvidia.com/farm/latest/guides/job_stores.html){:target="_blank"}

等到定義完了job，就可以submit task了，透過這個API
```bash
/queue/management/tasks/submit
```

以教學的例子來看，具體是使用POST的方式將task的內容submit給queue
```sql
curl -X POST http://localhost:8222/queue/management/tasks/submit -H "accept: application/json" -H "Content-Type: application/json" -d "{\"user\": \"Username\",\"task_type\":\"hello-world\",\"task_args\": {}, \"task_function\": \"\", \"task_function_args\": {}, \"task_requirements\": {}, \"task_comment\": \"my first test\", \"status\": \"submitted\"}"
```

實際上task中沒有給定更多的參數，因此結果上就只是執行job所定義好的command而已，值得注意的是這裡頭的task type是 **_hello\-world_** ，這個名稱必須要在job stores中找到。

實際上，可以直接在dashboard中看到很多資訊，例如


![Figure 4\. http://localhost:8222/queue/management/dashboard/job](/assets/0fdb74ed85ce/1*cgP5yeYQ4M9tF-uGTMrTXQ.png)

Figure 4\. http://localhost:8222/queue/management/dashboard/job

可以在DEFINITIONS找到Queue中有甚麼樣的jobs，我們就不需要再透過API來查詢，像我們這邊就定義了兩種job，並且執行了兩個task，task的資訊也可以在dashboard中查看。


![Figure 5\. http://localhost:8222/queue/management/dashboard/tasks](/assets/0fdb74ed85ce/1*3_4IvSLHU-As4Pi7o8SXHQ.png)

Figure 5\. http://localhost:8222/queue/management/dashboard/tasks

簡單來說，你可以想像Queue就像是網站，只不過這個網站目前就部屬在自己的PC，Queue提供了API的接口，Queue會不間斷持續監聽，待我們上傳job跟task，經過排程就會通知agent需要執行任務，Queue作為我們跟Agent的接口，就像是前端會將我們的指令傳送到後端一樣。

最後我們可以整理一下主要使用的4個queue的API
```bash
/queue/management/jobs/save
/queue/management/jobs/load
/queue/management/jobs/remove
/queue/management/tasks/submit
```

前三者都是跟job有關的，task只有submit，因為task的cancel在dashboard中可以做到。

最後補充一個小細節，就是在Figure 3\. 可以看見有一個job\_type，他不是job name，也不是task type，事實上job\_type分為兩種，一個是base一個是kit\-service。


![[https://docs\.omniverse\.nvidia\.com/farm/latest/guides/jobdefs\_and\_tasks\.html\#job\-definition\-schema](https://docs.omniverse.nvidia.com/farm/latest/guides/jobdefs_and_tasks.html#job-definition-schema){:target="_blank"}](/assets/0fdb74ed85ce/1*iHlX0C3tlq2QKJVEyVMQyQ.png)

[https://docs\.omniverse\.nvidia\.com/farm/latest/guides/jobdefs\_and\_tasks\.html\#job\-definition\-schema](https://docs.omniverse.nvidia.com/farm/latest/guides/jobdefs_and_tasks.html#job-definition-schema){:target="_blank"}

本篇的方式屬於前者，至於後者概念上則是會去啟動Omniverse，換言之，前者較有彈性，無論是要跑python還是其他command，都可以在job中定義好，後者就比較限縮在單純的跑Omniverse的功能，猜測是因為OV farm當初就是設計來跑Omniverse的，所以才會有一個不同的type。

前者以本篇為例，因為當job\_type為”base”的時候，其實就是直接開terminal，然後執行command，以Figure 3的hello\-world\.kit為例，執行任務的時候其實就是執行
```rust
python -c 'print("Hello_World!")'
```

至於後者，我們將在下篇文章用movie capture為例介紹。

總之，到此為我們大概能夠理解OV farm的運作邏輯，實際上就是job跟task的機制，尤其是task type，是與job的名稱對應的，更詳細的細節可以參考

[**Job Definitions, Task Types, and Tasks \- Omniverse Farm**](https://docs.omniverse.nvidia.com/farm/latest/guides/jobdefs_and_tasks.html){:target="_blank"} 
[_Omniverse Farm is a scheduling system for executing configurable tasks on Windows or Linux systems\. Farm organizes and…_ docs\.omniverse\.nvidia\.com](https://docs.omniverse.nvidia.com/farm/latest/guides/jobdefs_and_tasks.html){:target="_blank"}



_[Post](https://medium.com/maochinn/ovx-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98-00-omniverse-farm-0fdb74ed85ce){:target="_blank"} converted from Medium by [ZMediumToMarkdown](https://github.com/ZhgChgLi/ZMediumToMarkdown){:target="_blank"}._
